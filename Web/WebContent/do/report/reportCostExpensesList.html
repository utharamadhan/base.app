<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:ifs="http://padiku.id">
<head>
<meta charset="ISO-8859-1"/>
<title>Company</title>
</head>
<style>
.dataTables_scrollBody {
	height : auto !important;
	min-height : 120px;
}
</style>
<body>
<div id="content" class="col-md-12">
	<div id="costExpensesReport-detail-container"></div>
	<div id="costExpensesReport-list-container">
	<div class="pageheader">
		<h4><i class="fa fa-tachometer"></i> Laporan / Biaya - Biaya
		<span></span></h4>
	</div>
	<div class="col-md-4 tile-body no-vpadding" style="margin:10px;">
		<a href="#" id="costExpensesReport-btn-add" class="btn btn-primary button-export-xls" style="margin-bottom:5px">Export to Excel &nbsp; <i class="fa fa-file-excel-o dropdown-plus"></i></a>
	</div>
	<div class="main">
		<div class="row">
			<div class="col-md-12">	
				<div id="costExpenses-custom-filter-datatable" class="row form-horizontal" style="margin-top:20px;margin-bottom:20px;">
					<div class="form-group">
                       	<label class="col-sm-1 control-label">&nbsp;</label>
                       	<div class="col-sm-3">
                         	<input type='text' id="transDateStart" name="transDateStart" placeholder="Periode Mulai" class="datepicker input-date form-control datatable-custom-filter"/>
                       	</div>
                   	</div>
                   	<div class="form-group">
                       	<label class="col-sm-1 control-label">&nbsp;</label>
                       	<div class="col-sm-3"> 
                         	<input type='text' id="transDateEnd" name="transDateEnd" placeholder="Periode Berakhir" class="datepicker input-date form-control datatable-custom-filter"/>
                       	</div>
                       	<div class="col-sm-3">
							<a href="#" id="costExpensesReport-btn-filter" class="btn btn-default btn-apply-filter" style="margin-bottom:5px">Apply Filter &nbsp; <i class="fa fa-filter dropdown-plus"></i></a>
						</div>
                   	</div>
				</div>
				<section class="tile transparent">
					<div class="table-responsive">
						<div class="tile-body rounded-corners">
	                      	<table id="costExpensesReport-list-table" class="table table-datatable table-custom">
		                        <thead>
		                          <tr>
		                            <th>Tanggal Transaksi</th>
									<th>Kode Biaya</th>
									<th>Deskripsi Biaya</th>
									<th>Total Biaya</th>
		                          </tr>
		                        </thead>
	                     	</table>
	                     	<div style="padding-bottom: 3px; bottom: 0;" th:replace="pagingDiv::pager (${pagingWrapper}, ${#dates.createNow()}, 'costExpensesReport-list-table', 'contentArea')">
							</div>
                     	</div>
					</div>
				</section>
				</div>
			</div>
		</div>
	</div>
</div>
<script th:inline="javascript">
	/*<![CDATA[*/
	
	    $(function(){
	    	var id = "costExpensesReport-list-table";
		    setMenuActive('reports');
		    var colDefs = [{ name : "transDate" , type : "date"}, 
	    	               { name : "descr" }, 
	    	               { name : "descr" },
	    	               { name : "fee" }
	    	               ];
		    var sURL = /*[[@{/do/reports/analisajualbeli/list?}]]*/ #;
		    var ajaxOpt = {
					url: sURL,
					type: 'GET',
					dataSrc: function(json){
						$('#txtPage_'+id).val(json.currentPage);
						$('#_txtOldPage_'+id).val(json.currentPage);
						$('#noOfPage').html(json.noOfPage);
						if(json.currentPage>1){				
							$('#btnPrev').css('display','');
						}else{
							$('#btnPrev').css('display','none');
						}
						if(json.currentPage<json.noOfPage){
							$('#btnNext').css('display','');
						}else{
							$('#btnNext').css('display','none');
						}
						return json.result;
					},
					data: function(d){
						for (var i = 0; i < d.columns.length; i++) {
					        column = d.columns[i];
					        column.searchRegex = column.search.regex;
					        column.searchValue = column.search.value;
					        delete(column.search);
					    }
						var obj = {};
						var transDateStart = "transDateStart";var transDateEnd = "transDateEnd";
						obj[transDateStart] = $("#transDateStart").val();
						obj[transDateEnd] = $("#transDateEnd").val();
						d.customFilters = obj;
						d.emptyList = $('#emptyList').val();
						d.page = $('#txtPage_'+id).val();
					}
				};
		    buildDataTableWithCustomFilter(/*[[@{/}]]*/, sURL, 'costExpensesReport-list-table', 450, colDefs, null, null, ajaxOpt);
		    
		    $('.datepicker').datepicker({
	    	    autoclose: true,
	    	    todayHighlight: true,
	    		format: 'dd/mm/yyyy',
	    		onSelect: function(dateText, datePicker) {
	    			$(this).attr('value', dateText);
    		    }
            });
	    });
	
	    function serializeFilter () {
			return $('.datatable-custom-filter').serialize();
		}
	    
	    var printToExcel = function(){
			var sURL = /*[[@{/do/reports/analisajualbeli/downloadExcel?}]]*/;
			sURL += serializeFilter();
			window.location.href = sURL;
		};
	
		$('.button-export-xls').click(function(e){
			e.preventDefault();
			printToExcel();
		});
		
		$('.btn-apply-filter').click(function(e){
			e.preventDefault();
			reloadDataTableSearchCustom('costExpensesReport-list-table', 'costExpensesReport-custom-filter-datatable');
		});
		
	/*]]>*/
</script>
</body>
</html>