<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:ifs="http://padiku.id">
<head>
<meta charset="ISO-8859-1"/>
<title>Company</title>
</head>
<style>
.dataTables_scrollBody {
	height : auto !important;
	min-height : 120px;
}
</style>
<body>
<div id="content" class="col-md-12">
	<div id="transInReport-detail-container"></div>
	<div id="transInReport-list-container">
	<div class="pageheader">
		<h4><i class="fa fa-tachometer"></i> Laporan / Penerimaan
		<span></span></h4>
	</div>
	<div class="col-md-2 tile-body no-vpadding" style="margin:10px;">
		<a href="#" id="transInReport-btn-add" class="btn btn-primary button-export-xls" style="margin-bottom:5px">Export to Excel &nbsp; <i class="fa fa-file-excel-o dropdown-plus"></i></a>
	</div>
	<div class="main">
		<div class="row">
			<div class="col-md-12">	
				<div id="transIn-custom-filter-datatable" class="row form-horizontal" style="margin-top:20px;margin-bottom:20px;">
					<div class="form-group">
                       	<label class="col-sm-1 control-label">&nbsp;</label>
                       	<div class="col-sm-3">
                         	<input type='text' id="inDateStart" name="inDateStart" placeholder="Periode Mulai" class="datepicker input-date form-control datatable-custom-filter"/>
                       	</div>
                       	<div class="col-sm-3">
                         	<select id="sourceType" name="sourceType" class="chosen-select chosen-transparent form-control datatable-custom-filter">
                         		<option value="">[ALL SOURCE TYPE]</option>
								<option th:each="opt : ${optionsSourceType}" th:value="${opt}" th:text="${opt}"></option>
							</select>
                       	</div>
                   	</div>
                   	<div class="form-group">
                       	<label class="col-sm-1 control-label">&nbsp;</label>
                       	<div class="col-sm-3"> 
                         	<input type='text' id="inDateEnd" name="inDateEnd" placeholder="Periode Berakhir" class="datepicker input-date form-control datatable-custom-filter"/>
                       	</div>
                       	<div class="col-sm-3">
                         	<select id="itemType" name="fkLookupItemType" class="chosen-select chosen-transparent form-control datatable-custom-filter">
                         		<option value="">[ALL ITEM TYPE]</option>
								<option th:each="opt : ${optionsItemType}" th:value="${opt.pkLookup}" th:text="${opt.nameId}"></option>
							</select>
                       	</div>
                       	<div class="col-sm-3">
							<a href="#" id="transInReport-btn-add" class="btn btn-default btn-apply-filter" style="margin-bottom:5px">Apply Filter &nbsp; <i class="fa fa-filter dropdown-plus"></i></a>
						</div>
                   	</div>
				</div>
				<section class="tile transparent">
					<div class="table-responsive">
						<div class="tile-body rounded-corners">
	                      	<table id="transInReport-list-table" class="table table-datatable table-custom">
		                        <thead>
		                          <tr>
		                            <th>Tanggal Penerimaan</th>
									<th>Kode Supplier</th>
									<th>Nama Supplier</th>
									<th>Kode Barang</th>
		                          	<th>Nama Barang</th>
		                          	<th>Satuan</th>
		                          	<th>Jumlah</th>
		                          	<th>Harga Beli</th>
		                          	<th>Nilai Bahan Baku</th>
		                          </tr>
		                        </thead>
	                     	</table>
	                     	<div style="padding-bottom: 3px; bottom: 0;" th:replace="pagingDiv::pager (${pagingWrapper}, ${#dates.createNow()}, 'transInReport-list-table', 'contentArea')">
							</div>
                     	</div>
					</div>
				</section>
				</div>
			</div>
		</div>
	</div>
</div>
<script th:inline="javascript">
	/*<![CDATA[*/
	
	    $(function(){
	    	var id = "transInReport-list-table";
		    setMenuActive('reports');
		    var colDefs = [{ name : "inDate" , type : "date"}, 
	    	               { name : "supplierCode" }, 
	    	               { name : "supplierName" },
	    	               { name : "productCode" },
	    	               { name : "productName" },
	    	               { name : "uomCode" },
	    	               { name : "volume" },
	    	               { name : "fee" },
	    	               { name : "totalFee" },
	    	               ];
		    var sURL = /*[[@{/do/reports/penerimaan/list?}]]*/ #;
		    var ajaxOpt = {
					url: sURL,
					type: 'GET',
					dataSrc: function(json){
						$('#txtPage_'+id).val(json.currentPage);
						$('#_txtOldPage_'+id).val(json.currentPage);
						$('#noOfPage').html(json.noOfPage);
						if(json.currentPage>1){				
							$('#btnPrev').css('display','');
						}else{
							$('#btnPrev').css('display','none');
						}
						if(json.currentPage<json.noOfPage){
							$('#btnNext').css('display','');
						}else{
							$('#btnNext').css('display','none');
						}
						return json.result;
					},
					data: function(d){
						for (var i = 0; i < d.columns.length; i++) {
					        column = d.columns[i];
					        column.searchRegex = column.search.regex;
					        column.searchValue = column.search.value;
					        delete(column.search);
					    }
						var obj = {};
						var inDateStart = "inDateStart";var inDateEnd = "inDateEnd";var sourceType = "sourceType";var itemType = "fkLookupItemType";
						obj[inDateStart] = $("#inDateStart").val();
						obj[inDateEnd] = $("#inDateEnd").val();
						obj[sourceType] = $("#sourceType :selected").val();
						obj[itemType] = $("#itemType :selected").val();
						d.customFilters = obj;
						d.emptyList = $('#emptyList').val();
						d.page = $('#txtPage_'+id).val();
					}
				};
		    buildDataTableWithCustomFilter(/*[[@{/}]]*/, sURL, 'transInReport-list-table', 450, colDefs, null, null, ajaxOpt);
		    
		    $('.datepicker').datepicker({
	    	    autoclose: true,
	    	    todayHighlight: true,
	    		format: 'dd/mm/yyyy',
	    		onSelect: function(dateText, datePicker) {
	    			$(this).attr('value', dateText);
    		    }
            });
	    });
	
	    function serializeFilter () {
			return $('.datatable-custom-filter').serialize();
		}
	
	    var printToExcel = function(){
			var sURL = /*[[@{/do/reports/penerimaan/downloadExcel?}]]*/;
			sURL += serializeFilter();
			window.location.href = sURL;
		};
	
		$('.button-export-xls').click(function(e){
			e.preventDefault();
			printToExcel();
		});
		
		$('.btn-apply-filter').click(function(e){
			e.preventDefault();
			reloadDataTableSearchCustom('transInReport-list-table', 'transIn-custom-filter-datatable');
		});
		
	/*]]>*/
</script>
</body>
</html>